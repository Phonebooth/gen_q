{erl_opts, [debug_info, 
            {parse_transform, pmod_pt}, 
            {parse_transform, lager_transform}, 
            warnings_as_errors,
            {platform_define, "^R1[4,5]", 'crypto_use_sha_mac'},
            {platform_define, "^R16B", 'crypto_use_hash'},
            {platform_define, "^17", 'crypto_use_hash'}
        ]}.

{deps, [{pmod_transform, ".*", {git, "git@github.com:Phonebooth/pmod_transform.git", {branch, "master"}}}, 
        {lager, ".*", {git, "git@github.com:Phonebooth/lager.git", {branch, "master"}}}
       ]}.

{lib_dirs, ["./deps", "."]}.

{port_envs, [{"CFLAGS", "$CFLAGS -m64 -fPIC"},
             {"darwin", "LDFLAGS", "$LDFLAGS c_src/c.o -L/Library/Frameworks/R.framework/Versions/3.1/Resources/lib -lgcc_s.1 -lpthread"},
             {"linux", "LDFLAGS", "$LDFLAGS c_src/c.o -lpthread"}]}.

{port_specs, [{"priv/gen_q_drv.so",
               ["c_src/*.o"]}]}.

{pre_hooks, [{compile, "c_src/c.sh c_src/c.o"},
             {clean, "rm -f c_src/c.o"}]}.
